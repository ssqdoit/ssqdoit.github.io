import{_ as s,o as a,c as i,R as n}from"./chunks/framework.6kMW32Hq.js";const u=JSON.parse('{"title":"解析 MSOffice Word 有序列表样式","description":"","frontmatter":{},"headers":[],"relativePath":"daily/解析MSOffice_Word有序列表样式.md","filePath":"daily/解析MSOffice_Word有序列表样式.md","lastUpdated":1708930023000}'),l={name:"daily/解析MSOffice_Word有序列表样式.md"},e=n(`<h1 id="解析-msoffice-word-有序列表样式" tabindex="-1">解析 MSOffice Word 有序列表样式 <a class="header-anchor" href="#解析-msoffice-word-有序列表样式" aria-label="Permalink to &quot;解析 MSOffice Word 有序列表样式&quot;">​</a></h1><blockquote><p>最近在处理一个功能： 复制 <code>Word</code> 中的有序列表，粘贴到我们的 <code>WebOffice</code> 中</p></blockquote><h2 id="中文有序列表常用样式如下" tabindex="-1">中文有序列表常用样式如下： <a class="header-anchor" href="#中文有序列表常用样式如下" aria-label="Permalink to &quot;中文有序列表常用样式如下：&quot;">​</a></h2><div class="language-txt vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>一、有序列表1</span></span>
<span class="line"><span>二、有序列表2</span></span>
<span class="line"><span>三、有序列表3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>壹、有序列表1</span></span>
<span class="line"><span>贰、有序列表2</span></span>
<span class="line"><span>叁、有序列表3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>甲、有序列表1</span></span>
<span class="line"><span>乙、有序列表2</span></span>
<span class="line"><span>丙、有序列表3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="微软-documentformat-文档" tabindex="-1">微软 DocumentFormat 文档 <a class="header-anchor" href="#微软-documentformat-文档" aria-label="Permalink to &quot;微软 DocumentFormat 文档&quot;">​</a></h2><blockquote><p>下面的链接中详细的说明了 <code>NumberFormatValues</code> 样式</p></blockquote><p><a href="https://learn.microsoft.com/en-us/dotnet/api/documentformat.openxml.wordprocessing.numberformatvalues?view=openxml-2.8.1" target="_blank" rel="noreferrer">NumberFormatValues Enum</a></p><h2 id="解析字段" tabindex="-1">解析字段 <a class="header-anchor" href="#解析字段" aria-label="Permalink to &quot;解析字段&quot;">​</a></h2><p>在处理粘贴式，获取粘贴的 <code>html</code> 进行样式解析，其中：</p><p>mso-level-number-format</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mso</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">number</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:chinese</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">counting</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>这种样式使用中文数字，例如一、二、三、四等。它是较为常见的中文文档有序列表样式，使用中文数字对文档进行编号</p><h2 id="其他字段" tabindex="-1">其他字段 <a class="header-anchor" href="#其他字段" aria-label="Permalink to &quot;其他字段&quot;">​</a></h2><p>这里我直接从 <code>Word</code> 文件解压的 <code>numbering.xml</code> 可以看到有序列表有哪些字段：</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:lvl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:ilvl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:start</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:numFmt</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;japaneseCounting&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:isLgl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;false&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:suff</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tab&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:lvlText</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;%1、&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:lvlJc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> w:val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;left&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">w:pPr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>可以看到除了 <code>mso-level-number-format</code> 定义了有序列表样式外，还有如下一些字段需要进行适配：</p><ol><li><p><code>&lt;w:lvl w:ilvl=&quot;0&quot;&gt;</code>: 定义编号的第一个级别（<code>ilvl=0</code>表示第一级别）</p></li><li><p><code>&lt;w:start w:val=&quot;1&quot;/&gt;</code>: 指定该级别的编号从1开始。</p></li><li><p><code>&lt;w:numFmt w:val=&quot;japaneseCounting&quot;/&gt;</code>: 使用日文计数格式。这意味着文档中的编号将采用日文的计数方式，例如：“一、二、三、...”</p></li><li><p><code>&lt;w:isLgl w:val=&quot;false&quot;/&gt;</code>: 表示不使用法律编号（<code>legal numbering</code>）</p></li><li><p><code>&lt;w:suff w:val=&quot;tab&quot;/&gt;</code>: 指定编号后的后缀是制表符（<code>Tab</code>）</p></li><li><p><code>&lt;w:lvlText w:val=&quot;%1、&quot;/&gt;</code>: 设置编号文本格式，使用 <code>%1、</code> 表示编号后跟一个顿号</p></li><li><p><code>&lt;w:lvlJc w:val=&quot;left&quot;/&gt;</code>: 将编号文本左对齐</p></li><li><p><code>&lt;w:pPr&gt;</code>: 段落属性标签</p></li></ol>`,17),t=[e];function p(h,r,o,k,d,c){return a(),i("div",null,t)}const g=s(l,[["render",p]]);export{u as __pageData,g as default};
